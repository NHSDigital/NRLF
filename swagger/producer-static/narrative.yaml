# This is an OpenAPI Specification (https://swagger.io/specification/)
# for the National Record Locator Producer FHIR API
# owned by NHS Digital (https://digital.nhs.uk/)
info:
  version: 1.0.0
  title: National Record Locator Producer - FHIR API
  contact:
    name: NHS Digital API Management
    url: "https://digital.nhs.uk/developer/help-and-support"
    email: api.management@nhs.net
  description: |
    ## Overview

    The National Record Locator (NRL) enables organisations to share patient data nationwide.  Rather than storing the
    data itself, it is used to share pointers to the data, held in provider systems.  It acts as an index and not a data
    repository.  Each document pointer is defined using the
    [FHIR R4 DocumentReference](http://hl7.org/fhir/documentreference.html) standard.

    ![National Record Locator](https://raw.githubusercontent.com/NHSDigital/nrl-producer-api/master/specification/nrl.png)

    Users of the service fall into the categories of:

    * producers - capable of creating and managing pointers
    * consumers - capable of searching and reading pointers

    The service removes the need for organisations to create duplicate copies of information across systems and
    organisations, by enabling access to up-to-date information directly from the source.

    It can be used to store and publish pointers to patient data held in health systems across England and to look up
    where relevant patient data is held.

    There is a growing list of health and social care organisations authorised to share records using NRL, and presently
    the pointers are classified into the following types:

    * [Mental Health Crisis Plan](http://snomed.info/sct/736253002)
    * [Emergency Healthcare Plan](http://snomed.info/sct/887701000000100)
    * [End of Life Care Coordination Summary](http://snomed.info/sct|861421000000109)
    * [National Early Warning Code 2](http://snomed.info/sct|1363501000000100)

    You can also retrieve booking and referral pointers however you can not currently do this by directly integrating with
    the National Record Locator, you must instead onboard to the [Booking and Referral - FHIR API](https://digital.nhs.uk/developer/api-catalogue/booking-and-referral-fhir)

    ### As a producer

    Producers can use this API to:

    * create pointers, restricted to document types agreed during the [onboarding](#api-description__onboarding) process
    * replace your pointers with a newer versions, superseding the old one
    * update the metadata associated with your pointers
    * delete pointers
    * search all pointers you created
    * read any pointer you created

    ### What has changed?

    This service is a replacement for the existing
    [National Record Locator (NRL)](https://digital.nhs.uk/services/national-record-locator), and has the following
    changes:

    * upgraded from FHIR STU3 to R4.
    * improved performance and scalability.
    * improved onboarding experience.
    * authenticated using [signed JWT](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/application-restricted-restful-apis-signed-jwt-authentication) rather than mTLS.
    * greater flexibility, by wider support of the [FHIR R4 DocumentReference](http://hl7.org/fhir/documentreference.html) resource.

    ### Data availability, timing and quality

    Pointers are available to be consumed almost immediately after they have been produced by the provider.

    Pointers are immediately available to authorised providers and consumers after successful creation.

    ## Who can use this API

    This API can only be used where there is a legal basis to do so. Make sure you have a valid use case before you go
    too far with your development. You must demonstrate you have a valid use case as part of digital onboarding.

    You must have the capability to verify NHS numbers by one of the following mechanisms:

      * full PDS Spine compliant system
      * Spine Mini Service PDS (SMSP)

    Connecting parties must have an appointed Clinical Safety Officer and undertake a Clinical Safety Assessment.

    You must do this before you can go live (see ‘[Onboarding](#api-description__onboarding)’ below).

    ## API status and roadmap

    This API is [in development](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#statuses).

    To see our roadmap, or to suggest, comment or vote on features for this API, see our [interactive product backlog](https://nhs-digital-api-management.featureupvote.com/?tag=national-record-locator-api).

    If you have any other queries, [contact us](https://digital.nhs.uk/developer/help-and-support).

    ## Service level

    This API is a bronze service, meaning it is operational and supported only during business hours (8am to 6pm), Monday to Friday excluding bank holidays.

    For more details, see [service levels](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#service-levels).

    ## Technology

    This API is [RESTful](https://digital.nhs.uk/developer/guides-and-documentation/our-api-technologies#basic-rest).

    It conforms to the [FHIR](https://digital.nhs.uk/developer/guides-and-documentation/our-api-technologies#fhir) global standard for health care data exchange, specifically to [FHIR R4 (v4.0.1)](https://hl7.org/fhir/r4/), except that it does not support the [capabilities](http://hl7.org/fhir/R4/http.html#capabilities) interaction.

    It includes some country-specific FHIR extensions, which conform to [FHIR UK Core](https://digital.nhs.uk/services/fhir-uk-core), specifically [fhir.r4.ukcore.stu1 0.5.1](https://simplifier.net/packages/fhir.r4.ukcore.stu1/0.5.1).

    You do not need to know much about FHIR to use this API - FHIR APIs are just RESTful APIs that follow specific rules.

    In particular:

    * resource names are capitalised and singular, and use US spellings, for example `Organization` not `organisations`
    * array names are singular, for example `entry` not `entries` for address lines
    * data items that are country-specific and thus not included in the FHIR global base resources are usually wrapped in an `extension` object

    There are [libraries and SDKs available](https://digital.nhs.uk/developer/guides-and-documentation/api-technologies-at-nhs-digital#fhir-libraries-and-sdks) to help with FHIR API integration.

    ## Network access

    This API is available on the internet and, indirectly, on the [Health and Social Care Network (HSCN)](https://digital.nhs.uk/services/health-and-social-care-network).

    For more details see [Network access for APIs](https://digital.nhs.uk/developer/guides-and-documentation/network-access-for-apis).

    ## Security and authorisation

    This API uses the following access modes:

    * [Application-restricted RESTful API - signed JWT authentication](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/application-restricted-restful-apis-signed-jwt-authentication)

    ## Environments and testing

    | Environment       | Base URL                                                               |
    | ----------------- | ---------------------------------------------------------------------- |
    | Sandbox           | `https://sandbox.api.service.nhs.uk/record-locator/producer/FHIR/R4/`     |
    | Integration test  | `https://int.api.service.nhs.uk/record-locator/producer/FHIR/R4/`         |

    ### Sandbox testing

    Our [sandbox environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#sandbox-testing):

    * is for early developer testing
    * only covers a limited set of scenarios
    * is open access, so does not allow you to test authorisation

    For details of sandbox test scenarios, or to try out the sandbox using our 'Try this API' feature, see the documentation for each endpoint.

    Alternatively, you can try out the sandbox using our Postman collection:

    [![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/TBC)

    ### Integration testing

    Our [integration test environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing):

    * is for formal integration testing
    * includes authorisation

    It also includes ready-to-use test data and scenarios.  For details [contact us](https://digital.nhs.uk/developer/help-and-support).

    For more details see [integration testing with our RESTful APIs](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing-with-our-restful-apis).

    ## Onboarding

    You need to get your software approved by us before it can go live with this API. We call this onboarding. The onboarding process can sometimes be quite long, so it’s worth planning well ahead.

    As part of this process, you need to demonstrate that you can manage risks and that your software conforms technically with the requirements for this API.

    Information on this page might impact the design of your software. For details, see [Onboarding support information](https://digital.nhs.uk/developer/api-catalogue/national-record-locator-producer-fhir/onboarding-support-information).

    To understand how our online digital onboarding process works, see [digital onboarding](https://digital.nhs.uk/developer/guides-and-documentation/digital-onboarding#using-the-digital-onboarding-portal).

    <div class="nhsd-m-emphasis-box nhsd-m-emphasis-box--emphasis nhsd-!t-margin-bottom-6" aria-label="Highlighted Information">
        <div class="nhsd-a-box nhsd-a-box--border-blue">
            <div class="nhsd-m-emphasis-box__image-box">
                <figure class="nhsd-a-image">
                    <picture class="nhsd-a-image__picture">
                        <img src="http://digital.nhs.uk/binaries/content/gallery/icons/play-circle.svg?colour=231f20" alt="" style="object-fit:fill">
                    </picture>
                </figure>
            </div>
            <div class="nhsd-m-emphasis-box__content-box">
                <div data-uipath="website.contentblock.emphasis.content" class="nhsd-t-word-break"><p class="nhsd-t-body">To get started, sign in or create a <a href="http://onboarding.prod.api.platform.nhs.uk/">developer account</a>, then select 'product onboarding'.</p></div>
            </div>
        </div>
    </div>

    ## Errors

    We use standard HTTP status codes to show whether an API request succeeded or not. They are usually in the range:

    * 200 to 299 if it succeeded, including code 202 if it was accepted by an API that needs to wait for further action
    * 400 to 499 if it failed because of a client error by your application
    * 500 to 599 if it failed because of an error on our server

    Errors specific to each API are shown in the Endpoints section, under Response. See our [reference guide](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#http-status-codes) for more on errors.

paths:
  /DocumentReference:
    post:
      summary: Create new, or Supersede existing, document pointers
      description: |
        Create new pointers, or Supersede existing ones.

        To create a document pointer you must ensure:

        * the body must be a valid [FHIR R4 DocumentReference](http://hl7.org/fhir/documentreference.html)
        * `id` is a composite of the ODS Code and an identifier that is locally unique to your system.  NRL does not
          generate globally unique ids, instead relies on producers to provide a locally unique id prefixed with their
          ODS code, making it globally unique. e.g.
          ```
          XYZ-1234567890
          ```
        * `subject` MUST be a `Patient` reference using a valid NHS number. e.g.
          ```
          "subject": {
            "identifier": {
              "system": "https://fhir.nhs.uk/Id/nhs-number",
              "value": "3495456481"
            }
          },
          ```
        * `custodian` MUST be an `Organization` reference using a valid ODS code, agreed during [onboarding](#api-description__onboarding). e.g.
          ```
          "custodian": {
            "identifier": {
              "system": "https://fhir.nhs.uk/Id/ods-organization-code",
              "value": "Y05868"
            }
          }
          ```
        * `type` MUST match one of the Document Types agreed during [onboarding](#api-description__onboarding). e.g.
          ```
          "type": {
            "coding\": [
              {
                "system": "http://snomed.info/sct",
                "code": "1363501000000100",
                "display": "Royal College of Physicians NEWS2 (National Early Warning Score 2) chart"
              }
            ]
          }
          ```
        * `content` MUST have at least one entry.
        * `content[].format[]` SHOULD indicate the mechanism for accessing documents, e.g.
          ```
          "format": [
            {
              "code": "ssp",
              "display": "Spine Secure Proxy"
            }
          ]
          ```

        To supersede existing pointers you must further specify:

        * at least one existing pointer in the `relatesTo` with a `code` of `replaces`.
          ```
          [
            {
              "code": "replaces",
              "target": {
                "type": "DocumentReference",
                "identifier": {
                  "value": "XYZ-1234567890"
                }
              }
            }
          ]
          ```

        * the following fields MUST match the pointers being superseded:
          * `subject`
          * `type`

        This will cause a new pointer to be created and superseded pointers to be deleted.  Multiple documents can
        be superseded.

      responses:
        "201":
          description: Create / Supersede successful response
          content:
            application/fhir+json:
              example:
                resourceType: OperationOutcome
                id: 76db24dc-324a-468a-bf02-c06e82279488
                meta:
                  profile:
                    - https://fhir.nhs.uk/StructureDefinition/NHSDigital-OperationOutcome
                issue:
                  - severity: information
                    code: informational
                    details:
                      coding:
                        - system: https://fhir.nhs.uk/CodeSystem/NRLF-SuccessCode
                          code: RESOURCE_CREATED
                          display: Resource created
                    diagnostics: Resource created

    get:
      summary: Retrieve document pointers (GET)
      description: |
        Search through document pointers.

        Results are restricted to pointers you created, but can be further filtered by `subject` and `type`.

        Results are limited to 20 records per request, and further records are available by submitting subsequent
        requests with the `next-page-token` found in the `meta` portion of the response.

        This operation is also available as a http POST, which is the preferred method (see below).
      responses:
        "200":
          description: successful response
          content:
            application/fhir+json:
              example:
                resourceType: Bundle
                type: searchset
                total: 2
                entry:
                  - resource:
                      resourceType: DocumentReference
                      id: Y05868-1834567891
                      meta:
                        profile:
                          - http://fhir.nhs.net/StructureDefinition/nrls-documentreference-1-0
                      masterIdentifier:
                        system: urn:ietf:rfc:3986
                        value: urn:oid:1.3.6.1.4.1.21367.2004.3.7
                      identifier:
                        - system: urn:ietf:rfc:3986
                          value: urn:oid:1.3.6.1.4.1.21367.2005.3.7.1134
                      status: current
                      docStatus: "preliminary "
                      type:
                        coding:
                          - system: http://snomed.info/sct
                            code: "1363501000000100"
                            display:
                              Royal College of Physicians NEWS2 (National Early Warning Score 2)
                              chart
                      category:
                        - coding:
                            - system: http://loinc.org
                              code: 34769-0
                              display: General medicine Physician attending Note
                      subject:
                        identifier:
                          system: https://fhir.nhs.uk/Id/nhs-number
                          value: "3495456481"
                      date: "2022-12-22T11:45:41+11:00"
                      author:
                        - identifier:
                            value: Practitioner/A782161SZ
                      authenticator:
                        identifier:
                          value: Organization/Y05868
                      custodian:
                        identifier:
                          system: https://fhir.nhs.uk/Id/ods-organization-code
                          value: Y05868
                      securityLabel:
                        - coding:
                            - system: http://terminology.hl7.org/CodeSystem/v3-Confidentiality
                              code: V
                              display: very restricted
                      content:
                        - attachment:
                            contentType: application/pdf
                            language: en-US
                            url: https://spine-proxy.national.ncrs.nhs.uk/p1.nhs.uk/EPAACS/PhysicianNote.pdf
                            creation: "2022-12-22T09:45:41+11:00"
                          format:
                            system: urn:oid:1.3.6.1.4.1.19376.1.2.3
                            code: urn:ihe:pcc:handp:2008
                            display: History and Physical Specification
                      context:
                        encounter:
                          - identifier:
                              value: Encounter/3495456481
                        event:
                          - coding:
                              - system: http://snomed.info/sct
                                code: "445627002"
                                display: Assessment using adult early warning scoring system
                        period:
                          start: "2022-12-20T09:00:41+11:00"
                          end: "2022-12-20T09:45:41+11:00"
                        facilityType:
                          coding:
                            - system: http://snomed.info/sct
                              code: "273580000"
                              display: London hospital pain chart assessment
                        related:
                          - identifier:
                              system: https://fhir.nhs.uk/Id/ods-organization-code
                              value: ROYAL COLLEGE OF PHYSICIANS OF LONDON
                  - resource:
                      resourceType: DocumentReference
                      id: Y05868-1234567891
                      meta:
                        profile:
                          - http://fhir.nhs.net/StructureDefinition/nrls-documentreference-1-0
                      masterIdentifier:
                        system: urn:ietf:rfc:3986
                        value: urn:oid:1.3.6.1.4.1.21367.2005.3.7
                      identifier:
                        - system: urn:ietf:rfc:3986
                          value: urn:oid:1.3.6.1.4.1.21367.2005.3.7.1234
                      status: current
                      docStatus: final
                      type:
                        coding:
                          - system: http://snomed.info/sct
                            code: "861421000000109"
                            display: End of life care coordination summary
                      category:
                        - coding:
                            - system: http://loinc.org
                              code: 55112-7
                              display: Document summary
                      subject:
                        identifier:
                          system: https://fhir.nhs.uk/Id/nhs-number
                          value: "3495456481"
                      date: "2022-12-21T10:45:41+11:00"
                      author:
                        - identifier:
                            value: Practitioner/A985657ZA
                      authenticator:
                        identifier:
                          value: Organization/Y05868
                      custodian:
                        identifier:
                          system: https://fhir.nhs.uk/Id/ods-organization-code
                          value: Y05868
                      description: Physical
                      securityLabel:
                        - coding:
                            - system: http://terminology.hl7.org/CodeSystem/v3-Confidentiality
                              code: V
                              display: very restricted
                      content:
                        - attachment:
                            contentType: application/pdf
                            language: en-US
                            url: https://spine-proxy.national.ncrs.nhs.uk/p1.nhs.uk/EPAACS/EOLSummaryReport.pdf
                            size: 3654
                            hash: 2jmj7l5rSw0yVb/vlWAYkK/YBwk=
                            title: Physical
                            creation: "2022-12-21T10:45:41+11:00"
                          format:
                            system: urn:oid:1.3.6.1.4.1.19376.1.2.3
                            code: urn:ihe:pcc:cm:2008
                            display: Care Management
                      context:
                        encounter:
                          - identifier:
                              value: Encounter/3495456481
                        event:
                          - coding:
                              - system: http://snomed.info/sct
                                code: "713058002"
                                display: End of life care planning
                        period:
                          start: "2022-12-21T09:00:41+11:00"
                          end: "2022-12-21T10:45:41+11:00"
                        facilityType:
                          coding:
                            - system: http://snomed.info/sct
                              code: "73770003"
                              display: Hospital-based outpatient emergency care center
                        sourcePatientInfo:
                          identifier:
                            value: Patient/3495456481
                        related:
                          - identifier:
                              system: https://fhir.nhs.uk/Id/ods-organization-code
                              value: TRAFFORD GENERAL HOSPITAL

  /DocumentReference/_search:
    post:
      summary: Retrieve document pointers (POST)
      description: |
        Search through document pointers.

        Results are restricted to pointers you created, but can be further filtered by `subject` and `type`.

        Results are limited to 20 records per request, and further records are available by submitting subsequent
        requests with the `next-page-token` found in the `meta` portion of the response.

        This operation is also available as a http GET for convenience (see above), but POST is preferred for the
        following reasons:

        * query string parameters are visible on the network and in logs, and may have privacy implications for consumers.
        * GET operations can be cached by intermediary network infrastructure, such as CDNs, routers and proxies.
        * URLs have a maximum length of 2,048 characters which complex searches can exceed.  NRL does not currently
        exceed this limit, but may evolve in the future.
      responses:
        "200":
          description: Successful response
          content:
            application/fhir+json:
              example:
                resourceType: Bundle
                type: searchset
                total: 2
                entry:
                  - resource:
                      resourceType: DocumentReference
                      id: Y05868-1834567891
                      meta:
                        profile:
                          - http://fhir.nhs.net/StructureDefinition/nrls-documentreference-1-0
                      masterIdentifier:
                        system: urn:ietf:rfc:3986
                        value: urn:oid:1.3.6.1.4.1.21367.2004.3.7
                      identifier:
                        - system: urn:ietf:rfc:3986
                          value: urn:oid:1.3.6.1.4.1.21367.2005.3.7.1134
                      status: current
                      docStatus: "preliminary "
                      type:
                        coding:
                          - system: http://snomed.info/sct
                            code: "1363501000000100"
                            display:
                              Royal College of Physicians NEWS2 (National Early Warning Score 2)
                              chart
                      category:
                        - coding:
                            - system: http://loinc.org
                              code: 34769-0
                              display: General medicine Physician attending Note
                      subject:
                        identifier:
                          system: https://fhir.nhs.uk/Id/nhs-number
                          value: "3495456481"
                      date: "2022-12-22T11:45:41+11:00"
                      author:
                        - identifier:
                            value: Practitioner/A782161SZ
                      authenticator:
                        identifier:
                          value: Organization/Y05868
                      custodian:
                        identifier:
                          system: https://fhir.nhs.uk/Id/ods-organization-code
                          value: Y05868
                      securityLabel:
                        - coding:
                            - system: http://terminology.hl7.org/CodeSystem/v3-Confidentiality
                              code: V
                              display: very restricted
                      content:
                        - attachment:
                            contentType: application/pdf
                            language: en-US
                            url: https://spine-proxy.national.ncrs.nhs.uk/p1.nhs.uk/EPAACS/PhysicianNote.pdf
                            creation: "2022-12-22T09:45:41+11:00"
                          format:
                            system: urn:oid:1.3.6.1.4.1.19376.1.2.3
                            code: urn:ihe:pcc:handp:2008
                            display: History and Physical Specification
                      context:
                        encounter:
                          - identifier:
                              value: Encounter/3495456481
                        event:
                          - coding:
                              - system: http://snomed.info/sct
                                code: "445627002"
                                display: Assessment using adult early warning scoring system
                        period:
                          start: "2022-12-20T09:00:41+11:00"
                          end: "2022-12-20T09:45:41+11:00"
                        facilityType:
                          coding:
                            - system: http://snomed.info/sct
                              code: "273580000"
                              display: London hospital pain chart assessment
                        related:
                          - identifier:
                              system: https://fhir.nhs.uk/Id/ods-organization-code
                              value: ROYAL COLLEGE OF PHYSICIANS OF LONDON
                  - resource:
                      resourceType: DocumentReference
                      id: Y05868-1234567891
                      meta:
                        profile:
                          - http://fhir.nhs.net/StructureDefinition/nrls-documentreference-1-0
                      masterIdentifier:
                        system: urn:ietf:rfc:3986
                        value: urn:oid:1.3.6.1.4.1.21367.2005.3.7
                      identifier:
                        - system: urn:ietf:rfc:3986
                          value: urn:oid:1.3.6.1.4.1.21367.2005.3.7.1234
                      status: current
                      docStatus: final
                      type:
                        coding:
                          - system: http://snomed.info/sct
                            code: "861421000000109"
                            display: End of life care coordination summary
                      category:
                        - coding:
                            - system: http://loinc.org
                              code: 55112-7
                              display: Document summary
                      subject:
                        identifier:
                          system: https://fhir.nhs.uk/Id/nhs-number
                          value: "3495456481"
                      date: "2022-12-21T10:45:41+11:00"
                      author:
                        - identifier:
                            value: Practitioner/A985657ZA
                      authenticator:
                        identifier:
                          value: Organization/Y05868
                      custodian:
                        identifier:
                          system: https://fhir.nhs.uk/Id/ods-organization-code
                          value: Y05868
                      description: Physical
                      securityLabel:
                        - coding:
                            - system: http://terminology.hl7.org/CodeSystem/v3-Confidentiality
                              code: V
                              display: very restricted
                      content:
                        - attachment:
                            contentType: application/pdf
                            language: en-US
                            url: https://spine-proxy.national.ncrs.nhs.uk/p1.nhs.uk/EPAACS/EOLSummaryReport.pdf
                            size: 3654
                            hash: 2jmj7l5rSw0yVb/vlWAYkK/YBwk=
                            title: Physical
                            creation: "2022-12-21T10:45:41+11:00"
                          format:
                            system: urn:oid:1.3.6.1.4.1.19376.1.2.3
                            code: urn:ihe:pcc:cm:2008
                            display: Care Management
                      context:
                        encounter:
                          - identifier:
                              value: Encounter/3495456481
                        event:
                          - coding:
                              - system: http://snomed.info/sct
                                code: "713058002"
                                display: End of life care planning
                        period:
                          start: "2022-12-21T09:00:41+11:00"
                          end: "2022-12-21T10:45:41+11:00"
                        facilityType:
                          coding:
                            - system: http://snomed.info/sct
                              code: "73770003"
                              display: Hospital-based outpatient emergency care center
                        sourcePatientInfo:
                          identifier:
                            value: Patient/3495456481
                        related:
                          - identifier:
                              system: https://fhir.nhs.uk/Id/ods-organization-code
                              value: TRAFFORD GENERAL HOSPITAL

  /DocumentReference/{id}:
    get:
      summary: Get a single document pointer
      description: |
        Read a single document pointer by specifying the `DocumentReference.id`.  Note that you will only be able to
        retrieve document pointers that have been created by the organisation specified in the `ODS-End-User-Organisation-ODS`
        header, and agreed during [onboarding](#onbaroding).
      responses:
        "200":
          description: Successful response
          content:
            application/fhir+json:
              example:
                resourceType: DocumentReference
                id: Y05868-1234567892
                status: current
                docStatus: final
                type:
                  coding:
                    - system: http://snomed.info/sct
                      code: "887701000000100"
                      display: Emergency health care plan
                category:
                  - coding:
                      - system: http://loinc.org
                        code: 68552-9
                        display: Emergency medicine Emergency department Admission evaluation note
                subject:
                  identifier:
                    system: https://fhir.nhs.uk/Id/nhs-number
                    value: "4409815415"
                date: "2022-12-22T11:45:41+11:00"
                author:
                  - identifier:
                      value: Practitioner/A985657ZA
                authenticator:
                  identifier:
                    value: Organization/Y05868
                custodian:
                  identifier:
                    system: https://fhir.nhs.uk/Id/ods-organization-code
                    value: Y05868
                securityLabel:
                  - coding:
                      - system: http://terminology.hl7.org/CodeSystem/v3-Confidentiality
                        code: V
                        display: very restricted
                content:
                  - attachment:
                      contentType: application/pdf
                      language: en-US
                      url: https://spine-proxy.national.ncrs.nhs.uk/p1.nhs.uk/EPAACS/EmergencyCarPlan.pdf
                      creation: "2022-12-22T09:45:41+11:00"
                    format:
                      system: urn:oid:1.3.6.1.4.1.19376.1.2.3
                      code: urn:ihe:pcc:handp:2008
                      display: History and Physical Specification
                context:
                  encounter:
                    - identifier:
                        value: Encounter/4409815415
                  event:
                    - coding:
                        - system: http://snomed.info/sct
                          code: "702779007"
                          display: Emergency health care plan agreed
                  period:
                    start: "2022-12-20T09:00:41+11:00"
                    end: "2022-12-20T09:45:41+11:00"
                  facilityType:
                    coding:
                      - system: http://snomed.info/sct
                        code: "453121000124107"
                        display: Emergency department healthcare professional
                  related:
                    - identifier:
                        system: https://fhir.nhs.uk/Id/ods-organization-code
                        value: EMERGENCY DEPT PRIMARY CARE STREAMING

    put:
      summary: Update a single document pointer
      description: |
        Update a single pointer you created.

        Note that the following fields cannot change:
        * `id`
        * `subject`
        * `custodian`
        * `type`
        * `masterIdentifier`
        * `identifier`
        * `status`
        * `date`
        * `relatesTo`
        * `author`

        Note that unlike NRL STU3 changing the `status` field does NOT delete document pointers.  To delete document
        pointers use the `DELETE` endpoint.

      responses:
        "200":
          description: Successful response
          content:
            application/fhir+json:
              example:
                resourceType: OperationOutcome
                id: fc39effb-144c-4342-bdf2-4214f0cb728b
                meta:
                  profile:
                    - https://fhir.nhs.uk/StructureDefinition/NHSDigital-OperationOutcome
                issue:
                  - severity: information
                    code: informational
                    details:
                      coding:
                        - system: https://fhir.nhs.uk/CodeSystem/NRLF-SuccessCode
                          code: RESOURCE_UPDATED
                          display: Resource updated
                    diagnostics: Resource updated
        "201":
          description: Successful response
          content:
            application/fhir+json:
              example:
                resourceType: OperationOutcome
                id: fc39effb-144c-4342-bdf2-4214f0cb728b
                meta:
                  profile:
                    - https://fhir.nhs.uk/StructureDefinition/NHSDigital-OperationOutcome
                issue:
                  - severity: information
                    code: informational
                    details:
                      coding:
                        - system: https://fhir.nhs.uk/CodeSystem/NRLF-SuccessCode
                          code: RESOURCE_UPDATED
                          display: Resource updated
                    diagnostics: Resource updated

    delete:
      summary: Delete a single document pointer
      description: |
        Delete a single document pointer that your created.
      responses:
        "200":
          description: Successful response
          content:
            application/fhir+json:
              example:
                resourceType: OperationOutcome
                id: c6113a50-70bf-436e-b417-7c8024d2e8bf
                meta:
                  profile:
                    - https://fhir.nhs.uk/StructureDefinition/NHSDigital-OperationOutcome
                issue:
                  - severity: information
                    code: informational
                    details:
                      coding:
                        - system: https://fhir.nhs.uk/CodeSystem/NRLF-SuccessCode
                          code: RESOURCE_REMOVED
                          display: Resource removed
                    diagnostics: Resource removed
        "204":
          description: Successful response
          content:
            application/fhir+json:
              example:
                resourceType: OperationOutcome
                id: c6113a50-70bf-436e-b417-7c8024d2e8bf
                meta:
                  profile:
                    - https://fhir.nhs.uk/StructureDefinition/NHSDigital-OperationOutcome
                issue:
                  - severity: information
                    code: informational
                    details:
                      coding:
                        - system: https://fhir.nhs.uk/CodeSystem/NRLF-SuccessCode
                          code: RESOURCE_REMOVED
                          display: Resource removed
                    diagnostics: Resource removed

components:
  schemas:
    RequestQuerySubject:
      example: "https://fhir.nhs.uk/Id/nhs-number|4409815415"
    RequestQueryType:
      example: "http://snomed.info/sct|736253002"
    RequestHeaderRequestId:
      example: 60E0B220-8136-4CA5-AE46-1D97EF59D068
    RequestHeaderCorrelationId:
      example: 11C46F5F-CDEF-4865-94B2-0EE0EDCC26DA

  parameters:
    id:
      examples:
        valid:
          summary: Valid
          value: Y05868-1234567892
        invalid:
          summary: Unknown
          value: Y05861-1234567800
    odsCode:
      examples:
        valid:
          summary: Valid
          value: Y05868
        invalid:
          summary: Unknown
          value: XYZ
    subject:
      examples:
        none:
          summary: None
          value: ""
        valid_1:
          summary: "Valid #1"
          value: https://fhir.nhs.uk/Id/nhs-number|4409815415
        valid_2:
          summary: "Valid #2"
          value: https://fhir.nhs.uk/Id/nhs-number|3495456481
        invalid:
          summary: Unknown
          value: https://fhir.nhs.uk/Id/nhs-number|3495456001
    type:
      examples:
        none:
          summary: None
          value: ""
        SNOMED_CODES_MENTAL_HEALTH_CRISIS_PLAN:
          summary: Mental Health Crisis Plan
          value: http://snomed.info/sct|736253002
        SNOMED_CODES_EMERGENCY_HEALTH_CARE_PLAN:
          summary: Emergency Healthcare Plan
          value: http://snomed.info/sct|887701000000100
        SNOMED_CODES_END_OF_LIFE_CARE_COORDINATION_SUMMARY:
          summary: End of Life Care Coordination Summary
          value: http://snomed.info/sct|861421000000109
        SNOMED_CODES_NATIONAL_EARLY_WARNING_SCORE_2:
          summary: National Early Warning Code 2
          value: http://snomed.info/sct|1363501000000100
        invalid:
          summary: Unknown
          value: http://snomed.info/sct|410970009

  headers:
    CorrelationId:
      schema:
        example: 11C46F5F-CDEF-4865-94B2-0EE0EDCC26DA
        description: |
          The X-Correlation-ID from the request header, if supplied, mirrored back.
    RequestId:
      schema:
        example: 60E0B220-8136-4CA5-AE46-1D97EF59D068
        description: |
          The X-Request-ID from the request header, if supplied, mirrored back.
